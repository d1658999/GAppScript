
# Google Apps Script (GAS) Coding Guidelines

## 基本原則

- **務必使用 V8 Runtime。**
- **嚴禁使用 `var`，一律以 `const`（預設）或 `let`（需重新賦值時）宣告變數。**
- **命名規則：**
	- 變數與函式：`camelCase`
	- 常數：`UPPER_SNAKE_CASE`
	- 類別/建構子：`UpperCamelCase`
- **檔案名稱：** 全小寫，單字以底線或破折號分隔（如 `my_script.js`）。

## 格式與結構

- **縮排：** 2 空格，不使用 Tab。
- **每行長度：** 最多 80 字元，必要時換行。
- **每行僅一敘述句，結尾必加分號。**
- **區塊（如 if/for/while）必加大括號，即使僅一行。**
- **物件與陣列換行時，最後一項也加逗號。**

## 註解與文件

- **所有公開函式、類別、屬性必須撰寫 JSDoc，並說明權限需求與參數型態。**
	- 範例：
		```js
		/**
		 * 取得使用者資料。
		 * @param {string} userId 使用者 ID
		 * @return {Object} 使用者資訊
		 * @permission SpreadsheetApp, DriveApp
		 */
		function getUserData(userId) { ... }
		```
- **私有函式建議加上簡短註解。**
- **多行註解請用 `/* ... */`，單行註解用 `//`。**
- **避免冗長註解，保持簡潔明確。**

## 日誌與除錯

- **僅使用 `Logger.log`，嚴禁 `console.log`。**
- **移除所有除錯用的日誌，除非有明確紀錄需求。**

## 錯誤處理

- **適當使用 try/catch 處理例外，並記錄錯誤資訊。**
- **避免空的 catch 區塊，必要時加註解說明。**

## 安全與權限

- **公開函式必須於 JSDoc 標明所需權限（如 SpreadsheetApp、DriveApp 等）。**
- **避免硬編碼敏感資訊（如 API 金鑰、密碼），建議使用 PropertiesService。**

## 程式組織與模組化

- **每個檔案聚焦單一主題或功能。**
- **大型專案請拆分多檔案，並以清楚命名區分。**
- **避免全域變數，必要時以常數或物件封裝。**

## 其他最佳實踐

- **避免重複程式碼，善用函式重構。**
- **善用 ES6+ 語法（如箭頭函式、解構賦值、展開運算子等）。**
- **嚴禁使用 `eval`、`with`、或修改內建物件原型。**

---
如需更詳細規範，請參考 [Google JavaScript Style Guide](https://google.github.io/styleguide/jsguide.html)。